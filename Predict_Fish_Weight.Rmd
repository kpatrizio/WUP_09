---
title: "Weight of Fish"
author: "Kelly Patrizio"
date: "October 28, 2020"
output: 
  html_document:
    number_sections: true
    toc: true
---


```{r include=FALSE,echo=FALSE}
require(tigerstats)
require(tidyverse)
```

```{r}
Fishdata=read.csv("Fish.csv", header = TRUE)
```


# Introduction

<!--In this section you explain what you are trying to show.  Where did the data come from?  What is the research or other question you are trying to answer?!-->

## Build the best regression model you can that predicts the weight of perch
## Using only two predictor variables 


# Methods

<!--Decide on your methods:  use "variable analysis" or other appropriate descriptors.  Make sure to choose at least one graphical method and at least one numerical method.!-->

we are using num~num because the variables we are looking at are all numerical explanatory variables.

#Results

<!--Divide this section into two sub-sections:  One for your descriptive  results and one for your inferential results.!-->

## Descriptive Results

### Graphical Descriptive Results for Perch

<!--Graphical results here.  Make sure to show your code.  Provide appropriate labels for axes, giving units if possible, and provide a good title for the graph, too.  Use the graphical results to describe the patterns if any that exist in the data as focused toward the research question!-->


```{r}
Fishies=filter(Fishdata, Species =="Perch")
Fishies=select(Fishies,-Species)
pairs(Fishies)
``` 
The best plot for the  linear model of species "Perch" according to the above 
chart appears to be Length 2

### Numerical Descriptive Results for Perch

<!--Numerical results go here. Use the numerical results to describe the patterns if any that exist in the data as focused toward the research question!-->


```{r}
summary(Fishies)
```

In the above numerical graphs for Perch the summary chart appears to show the 
Max. weight of 1100.0 oz   Max. Length of 44.00 for the lm for length2, a
Max. Height of 12.800 in. and a Max. width of 8.142 in


```{r}
Perchmodel=lm(Weight~Length2+Width,data=Fishies)
summary(Perchmodel)
```


The perch model shows an adj r-squared prediction of 0.9341 which is pretty close
to our highest regression.

```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = Fishies,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out, statistic="adjr2",legend="bottomright",main="Adjusted R^2")
```

In the above subset model it appears that subset size 2 @ 0.9400 adjr2 
calculates that Height and width  variables give the best  predictor of models.


## Inferential Results for Perch

<!--State hypothesis clearly.  Make sure your discussion of the inferential test covers all the aspects that the test output produces, such as test statistic, p-value etc.  Make a decision about the null hypothesis, explain the assumptions on which the selected test/procedure was based, and why the chosen procedure satisfies the assumptions and is appropriate to answer the research question!-->

  
```{r}
model.1 <- lm(Weight~Length2+Width,data=Fishies)
summary.lm(model.1)
```

The inferential test above agrees with the adjr2 prediction of 0.9341,using the 
variables...weight, length 2, and width.  Therefore, it would appear that the 
subset chart using only variables height and width having an adj score 0f 
0.9400 would be the best model to make the best prediction.

## Build the best regression model you can that predicts the weight of Bream
## Using only two predictor variables 


### Graphical Descriptive Results for Bream

```{r}
FishiesB=filter(Fishdata, Species =="Bream")
FishiesB=select(FishiesB,-Species)
pairs(FishiesB)
```

In the above Graphical descriptive result chart for "Bream" it appears that 
length 1 would give us the best model regression to tesdt the prediction.


### Numerical Descriptive Results for Bream

```{r}
summary(FishiesB)
```

In the above summary we have a max. weight of 1000 oz with a max length of 
38 in. using the Length1 variable and a max Height of 18.96 in. and a max
width of 6.8 in.

```{r}
Breammodel2=lm(Weight~Length1+ Width,data=FishiesB)
summary(Breammodel2)
```

In the Bream model 2 above we see an adjr2 of 0.9084.

```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = FishiesB,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="bottomright",main="Adjusted R^2")
```

In the subset chart above we can see at a subset size of 2 variables that 
Length2 and Height would be the best variables to predict the results.  
It appears we have an adjr2 score a little above 0.935.


## Inferential Results for Bream

  
```{r}
model.2 <- lm(Weight~Length1+Width,data=FishiesB)
summary.lm(model.2)
```

The inferential chart above appears to have an adjr2 prediction of 0.9084 still 
which agrees with the Model2 above.  It appears that the variables for the
bream that best predict using the subset model is Length2 and Height with 
and adjr2 of a little above 0.0935.  

## Build the best regression model you can that predicts the weight of Smelt
## Using only two predictor variables 


### Graphical Descriptive Results for Smelt

```{r}
FishiesS=filter(Fishdata, Species =="Smelt")
FishiesS=select(FishiesS,-Species)
pairs(FishiesS)
```

In the above graphical descriptive results chart for "Smelt", it appears that
Length3 would be the best lm to make a prediction.

### Numerical Descriptive Results for Smelt

```{r}
summary(FishiesS)
```

In the above summary chart for species "Smelt", it would appear that the
max weight for Smelt is 19.9 oz with a max length of 16.2 in. according to the 
Length3 lm.  and a max Height of 2.9 in. and a max Width of 2.1 in.


```{r}
Smeltmodel3=lm(Weight~Length3 + Width,data=FishiesS)
summary(Smeltmodel3)
```

The model3 above for Smelt appears to have an adjr2 of  0.9551


```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = FishiesS,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="bottomright",main="Adjusted R^2")
```

when we observe the subset chart it appears that the subset size of 2 
variables, shows that Length2 and Width are the best two variables to make a 
prediction at an adjr2 of 0.965.  Therefore, Length3 would not be the best
variable to get the best prediction.  

## Inferential Results for Smelt
  
```{r}
model.3 <- lm(Weight~Length3+Width,data=FishiesS)
summary.lm(model.3)
```

The inferential chart above for Smelt appears to have an adjr2 of 0.9551  
using the variable Length3 which is lower than the 0.965 in the adjr2 subset 
chart above.

# Discussion and Conclusion

<!--Discussion and conclusion here.  If you found a relationship be sure to consider whether the relationship occurs because one of the variables causes the other, or whether they perhaps are related for some other reason.  Watch the chapter 6 videos from the George Town videos collection.!-->

In conclusion the best regression model appears to be as follows.

# Conclusion for Perch

For the Perch species it appears the best regression model in scatter
plots is that of variable Length2 and appears to be the best variable to use, 
along with weight and adding width.
Using these variables for our summary perch model1 and our sub-set models, 
it would appear that the best model to use would be the subset model with an 
adjr2 0f 0.9400.  

For the Bream species it appears the best regression model would include 
the variable Length1 along with the variables Weight and width.
Using these variables for our summary Bream model2 and our sub-set models, 
it would appear that the best model to use would be the subset model with an 
adjr2 0f 0.934. The Breammodel2 and the Inferential test had an adjr2 of 0.9084.

For the Smelt species, it appears the best regression model in scatter
plots is that of variable Length3 and appears to be the best variable to use, 
along with weight and adding width.  However, Using these variables for our
summary Smeltmodel3 and our sub-set models, it would appear that the best 
variable would not be Length3 to make the prediction, but instead, according 
to the subset adj rsqr2 model, it appears that Length2 and width are the best 
variables giving the highest adj rsqr2 0f 0.965, making it to be the best
regression model of prediction. The models smeltmodel2 and the inferential 
model show a lower adjr2 of 0.9551 which is lower than the 0.965 from the 
subset model.

It appears that the best model for all three species was the subset adjr2 
models.







